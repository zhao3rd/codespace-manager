# âœ… Streamlit Cloud GitHub å­˜å‚¨é—®é¢˜ - è§£å†³æ–¹æ¡ˆæ€»ç»“

## ä½ çš„é—®é¢˜

> åœ¨ Streamlit Cloud ä¸­è¿è¡Œï¼Œæ²¡æœ‰ä¿å­˜æˆåŠŸåˆ° GitHub repo ä¸­çš„ keepalive ä¿¡æ¯ï¼Œå·²ç»åœ¨ secrets ä¸­é…ç½®äº†

## ğŸ¯ æˆ‘ä¸ºä½ åšçš„æ”¹è¿›

### 1. å¢å¼ºçš„è°ƒè¯•æ—¥å¿— ğŸ”

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `github_storage.py` - æ·»åŠ è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’ŒçŠ¶æ€æ—¥å¿—
- `keepalive_storage.py` - æ·»åŠ åç«¯é€‰æ‹©å’Œä¿å­˜è¿‡ç¨‹æ—¥å¿—

**ç°åœ¨çš„æ—¥å¿—è¾“å‡º**ï¼š
```
ğŸ’¾ Saving 1 keepalive task(s)...
ğŸ”§ Using GitHub storage backend
   Repo: username/repository
   Branch: main
   Token: âœ… configured
âœ… GitHub storage: Successfully saved 1 tasks
```

æˆ–è€…å¤±è´¥æ—¶ï¼š
```
âŒ GitHub storage: GitHub API error 404: Not Found
   URL: https://api.github.com/repos/username/repository/contents/codespace-manager/keepalive_tasks.json
   Repo: username/repository
   Branch: main
   File: codespace-manager/keepalive_tasks.json
```

### 2. è¯Šæ–­å·¥å…· ğŸ”§

**æ–°å»ºæ–‡ä»¶**ï¼š`test_github_storage.py`

**åŠŸèƒ½**ï¼š
1. âœ… æ£€æŸ¥ Secrets é…ç½®å®Œæ•´æ€§
2. âœ… éªŒè¯ Token æœ‰æ•ˆæ€§
3. âœ… æµ‹è¯•ä»“åº“è®¿é—®æƒé™
4. âœ… æ£€æŸ¥åˆ†æ”¯å­˜åœ¨æ€§
5. âœ… å®é™…æµ‹è¯•æ–‡ä»¶åˆ›å»º

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# éƒ¨ç½²è¿™ä¸ªæ–‡ä»¶ä¸ºç‹¬ç«‹åº”ç”¨ï¼Œæˆ–ä¸´æ—¶æ›¿æ¢ streamlit_app.py
streamlit run test_github_storage.py
```

### 3. è¯¦ç»†çš„æ’æŸ¥æŒ‡å— ğŸ“–

**æ–°å»ºæ–‡æ¡£**ï¼š

#### `TROUBLESHOOTING.md` - å®Œæ•´æ’æŸ¥æŒ‡å—
- 6 æ­¥è¯¦ç»†æ’æŸ¥æµç¨‹
- 5 ä¸ªæœ€å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ
- æ‰‹åŠ¨æµ‹è¯• GitHub API çš„æ–¹æ³•
- å®Œæ•´çš„é…ç½®æ¨¡æ¿

#### `QUICK_TROUBLESHOOTING.md` - 3 åˆ†é’Ÿå¿«é€Ÿè¯Šæ–­
- 3 æ­¥å¿«é€Ÿæ£€æŸ¥
- 5 ä¸ªæœ€å¸¸è§é—®é¢˜é€ŸæŸ¥
- å¿«é€Ÿé…ç½®æ¨¡æ¿

### 4. æ›´æ–°çš„æ–‡æ¡£é“¾æ¥ ğŸ“š

**æ›´æ–°æ–‡ä»¶**ï¼š
- `README.md` - æ·»åŠ æ•…éšœæ’æŸ¥æŒ‡å—é“¾æ¥
- `CLOUD_STORAGE_SETUP.md` - æ·»åŠ å¿«é€Ÿæ’æŸ¥é“¾æ¥
- `CHANGELOG.md` - è®°å½•æ‰€æœ‰æ”¹è¿›

---

## ğŸ” ç°åœ¨å¦‚ä½•æ’æŸ¥ä½ çš„é—®é¢˜

### æ­¥éª¤ 1ï¼šæŸ¥çœ‹ Streamlit Cloud æ—¥å¿—

1. æ‰“å¼€ä½ çš„ Streamlit Cloud åº”ç”¨
2. ç‚¹å‡»å³ä¸‹è§’ **Manage app**
3. é€‰æ‹© **Logs** æ ‡ç­¾
4. åˆ›å»ºä¸€ä¸ªä¿æ´»ä»»åŠ¡ï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡º

**æŸ¥æ‰¾ä»¥ä¸‹å…³é”®ä¿¡æ¯**ï¼š

#### å¦‚æœçœ‹åˆ°è¿™ä¸ª âœ…ï¼š
```
ğŸ”§ Using GitHub storage backend
   Repo: your-repo
âœ… GitHub storage: Successfully saved 1 tasks
```
â†’ é…ç½®æˆåŠŸï¼æ£€æŸ¥ GitHub ä»“åº“æ˜¯å¦æœ‰ `codespace-manager/keepalive_tasks.json`

#### å¦‚æœçœ‹åˆ°è¿™ä¸ª âŒï¼š
```
â„¹ï¸ 'github_storage' not found in Streamlit secrets
ğŸ“ Falling back to local file storage
```
â†’ Secrets é…ç½®æœ‰é—®é¢˜ï¼Œæ£€æŸ¥é…ç½®åç§°æ˜¯å¦æ­£ç¡®

#### å¦‚æœçœ‹åˆ°è¿™ä¸ª âŒï¼š
```
âŒ GitHub API error 401: Bad credentials
```
â†’ Token æ— æ•ˆæˆ–è¿‡æœŸ

#### å¦‚æœçœ‹åˆ°è¿™ä¸ª âŒï¼š
```
âŒ GitHub API error 404: Not Found
```
â†’ ä»“åº“è·¯å¾„é”™è¯¯æˆ–ä¸å­˜åœ¨

#### å¦‚æœçœ‹åˆ°è¿™ä¸ª âŒï¼š
```
âŒ GitHub API error 403: Resource not accessible
```
â†’ Token æƒé™ä¸è¶³ï¼Œéœ€è¦ `repo` æƒé™

### æ­¥éª¤ 2ï¼šæ£€æŸ¥ Secrets é…ç½®

ç¡®è®¤ä½ çš„ Secrets æ ¼å¼å®Œå…¨æ­£ç¡®ï¼š

```toml
[github_storage]
token = "ghp_your_actual_token_here"
repo = "your-username/your-repository"
branch = "main"
```

**å¸¸è§é”™è¯¯å¯¹ç…§è¡¨**ï¼š

| é”™è¯¯é…ç½® | æ­£ç¡®é…ç½® |
|---------|---------|
| `[github_storge]` | `[github_storage]` |
| `token = ghp_xxx`ï¼ˆæ— å¼•å·ï¼‰| `token = "ghp_xxx"` |
| `repo = "github.com/user/repo"` | `repo = "user/repo"` |
| `repo = "user/repo.git"` | `repo = "user/repo"` |

### æ­¥éª¤ 3ï¼šæ£€æŸ¥ Token æƒé™

1. è®¿é—®ï¼šhttps://github.com/settings/tokens
2. æ‰¾åˆ°ä½ çš„ Token
3. ç¡®è®¤å‹¾é€‰äº† `repo` æƒé™
4. å¦‚æœæ²¡æœ‰ï¼Œé‡æ–°ç”Ÿæˆå¹¶æ›´æ–° Secrets

### æ­¥éª¤ 4ï¼šè¿è¡Œè¯Šæ–­å·¥å…·

ä½¿ç”¨ `test_github_storage.py` è¿›è¡Œå…¨é¢è¯Šæ–­ï¼š

1. å°†æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“
2. ä¸´æ—¶éƒ¨ç½²ä¸ºç‹¬ç«‹åº”ç”¨
3. è¿è¡Œæ‰€æœ‰æµ‹è¯•
4. æŸ¥çœ‹è¯¦ç»†çš„è¯Šæ–­ç»“æœ

---

## ğŸ“Š æœ€å¯èƒ½çš„åŸå› 

æ ¹æ®ç»éªŒï¼Œé—®é¢˜é€šå¸¸æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š

### ğŸ¥‡ åŸå›  1ï¼šSecrets é…ç½®æ ¼å¼é”™è¯¯ï¼ˆ60%ï¼‰

**ç—‡çŠ¶**ï¼šæ—¥å¿—æ˜¾ç¤º `'github_storage' not found in Streamlit secrets`

**æ£€æŸ¥**ï¼š
- é…ç½®åç§°æ˜¯ `[github_storage]` è€Œä¸æ˜¯å…¶ä»–
- æ‰€æœ‰å€¼éƒ½ç”¨å¼•å·åŒ…è£¹
- æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼
- ä½¿ç”¨ TOML æ ¼å¼è€Œä¸æ˜¯ JSON

### ğŸ¥ˆ åŸå›  2ï¼šToken æƒé™ä¸è¶³ï¼ˆ25%ï¼‰

**ç—‡çŠ¶**ï¼šæ—¥å¿—æ˜¾ç¤º `403 Forbidden`

**æ£€æŸ¥**ï¼š
- Token æœ‰ `repo` æƒé™
- Token æ²¡æœ‰è¿‡æœŸ
- Token å¯¹åº”çš„ç”¨æˆ·æœ‰ä»“åº“å†™æƒé™

### ğŸ¥‰ åŸå›  3ï¼šä»“åº“è·¯å¾„é”™è¯¯ï¼ˆ10%ï¼‰

**ç—‡çŠ¶**ï¼šæ—¥å¿—æ˜¾ç¤º `404 Not Found`

**æ£€æŸ¥**ï¼š
- æ ¼å¼æ˜¯ `owner/repository` è€Œä¸æ˜¯ URL
- ä»“åº“ç¡®å®å­˜åœ¨
- æ²¡æœ‰æ‹¼å†™é”™è¯¯

### å…¶ä»–åŸå› ï¼ˆ5%ï¼‰

- åˆ†æ”¯åç§°é”™è¯¯ï¼ˆ`main` vs `master`ï¼‰
- Token æ ¼å¼é”™è¯¯ï¼ˆä¸æ˜¯ä»¥ `ghp_` å¼€å¤´ï¼‰
- ç½‘ç»œé—®é¢˜ï¼ˆæå°‘è§ï¼‰

---

## ğŸ¯ å»ºè®®çš„æ’æŸ¥é¡ºåº

1. **æŸ¥çœ‹æ—¥å¿—**ï¼ˆ2åˆ†é’Ÿï¼‰â†’ æ‰¾åˆ°å…·ä½“é”™è¯¯ä¿¡æ¯
2. **æ£€æŸ¥ Secrets æ ¼å¼**ï¼ˆ1åˆ†é’Ÿï¼‰â†’ ç¡®è®¤é…ç½®æ­£ç¡®
3. **éªŒè¯ Token æƒé™**ï¼ˆ1åˆ†é’Ÿï¼‰â†’ ç¡®è®¤æœ‰ `repo` æƒé™
4. **è¿è¡Œè¯Šæ–­å·¥å…·**ï¼ˆ3åˆ†é’Ÿï¼‰â†’ å…¨é¢æµ‹è¯•
5. **å‚è€ƒè¯¦ç»†æŒ‡å—**ï¼ˆ10åˆ†é’Ÿï¼‰â†’ æ·±å…¥æ’æŸ¥

---

## ğŸ“ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

### 1. Streamlit Cloud æ—¥å¿—
å¤åˆ¶æ‰€æœ‰åŒ…å« `GitHub storage` çš„æ—¥å¿—è¡Œ

### 2. Secrets é…ç½®ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰
```toml
[github_storage]
token = "ghp_å¼€å¤´çš„10ä¸ªå­—ç¬¦...ï¼ˆéšè—åé¢çš„ï¼‰"
repo = "å®Œæ•´è·¯å¾„"
branch = "åˆ†æ”¯å"
```

### 3. Token æƒé™æˆªå›¾
ä» GitHub Settings â†’ Tokens æˆªå›¾ï¼ˆéšè— Token å€¼ï¼‰

### 4. GitHub ä»“åº“ä¿¡æ¯
- ä»“åº“æ˜¯å…¬å¼€è¿˜æ˜¯ç§æœ‰ï¼Ÿ
- ä½ å¯¹ä»“åº“æœ‰ä»€ä¹ˆæƒé™ï¼ˆowner / write / readï¼‰ï¼Ÿ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“– [å®Œæ•´æ•…éšœæ’æŸ¥æŒ‡å—](TROUBLESHOOTING.md) - è¯¦ç»†æ­¥éª¤
- âš¡ [3åˆ†é’Ÿå¿«é€Ÿè¯Šæ–­](QUICK_TROUBLESHOOTING.md) - å¿«é€Ÿæ£€æŸ¥
- ğŸ”§ [äº‘å­˜å‚¨é…ç½®](CLOUD_STORAGE_SETUP.md) - é…ç½®è¯´æ˜
- ğŸ” [å®‰å…¨æŒ‡å—](SECURITY.md) - Token å’Œæƒé™

---

## âœ… æ€»ç»“

æˆ‘ä¸ºä½ åšçš„æ”¹è¿›ï¼š
1. âœ… æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—
2. âœ… åˆ›å»ºäº†è¯Šæ–­å·¥å…·
3. âœ… ç¼–å†™äº† 3 ä»½è¯¦ç»†çš„æ’æŸ¥æŒ‡å—
4. âœ… æ›´æ–°äº†æ‰€æœ‰ç›¸å…³æ–‡æ¡£

ç°åœ¨ä½ å¯ä»¥ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ‰¾åˆ°å…·ä½“é”™è¯¯
2. ä½¿ç”¨è¯Šæ–­å·¥å…·æµ‹è¯•é…ç½®
3. å‚è€ƒè¯¦ç»†æŒ‡å—è§£å†³é—®é¢˜

**é©¬ä¸Šå»æŸ¥çœ‹ Streamlit Cloud çš„æ—¥å¿—ï¼Œå‘Šè¯‰æˆ‘çœ‹åˆ°äº†ä»€ä¹ˆï¼Œæˆ‘ä¼šå¸®ä½ è¿›ä¸€æ­¥åˆ†æï¼** ğŸš€

