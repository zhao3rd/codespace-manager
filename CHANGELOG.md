# 更新日志

## [1.2.2] - 2025-10-26

### 💾 重要更新：保活任务持久化

1. **保活任务自动保存**
   - 新增 `keepalive_storage.py` 持久化模块
   - 保活任务保存到 `keepalive_tasks.json` 文件
   - 本地和 Streamlit Cloud 都支持

2. **自动恢复机制**
   - 应用重启时自动加载保活任务
   - 过滤已过期的任务
   - 恢复未过期任务的监控
   - 无缝继续保活

3. **数据安全**
   - `keepalive_tasks.json` 已加入 `.gitignore`
   - 不会提交到版本控制
   - 自动清理过期任务

### ⚡ 性能优化

- 保活检查频率调整为每 10 分钟（之前为每分钟）
- 减少 API 调用频率，更友好的资源使用
- 手动刷新按钮可立即检查状态

### 🎯 用户体验改进

- 成功启动保活时显示 "(saved)" 提示
- 关闭浏览器不影响保活任务
- 重启服务后保活任务继续有效

### 📚 文档更新

- 更新 `KEEPALIVE_GUIDE.md` - 添加持久化说明和新的检查频率
- 更新 `SECURITY.md` - 添加数据持久化说明
- 更新 `README.md` - 强调持久化特性

---

## [1.2.1] - 2025-10-26

### 🔧 改进

1. **重命名入口文件**
   - 将 `app.py` 重命名为 `streamlit_app.py`
   - 符合 Streamlit Cloud 默认规范
   - 部署时无需手动指定主文件

### 📚 文档更新

- 更新所有文档中的文件名引用
- 更新部署指南
- 新增 `STREAMLIT_CLOUD_DEPLOY.md`

---

## [1.2.0] - 2025-10-26

### 🎨 界面改进

1. **全新表格布局**
   - 重新设计 Codespace 列表为表格格式
   - 多列对齐显示：状态、名称、机器、位置、最后使用、操作
   - 所有按钮在同一行展示，对齐更整洁
   - 更清晰的信息层次结构

2. **每行刷新按钮**
   - 每个 Codespace 都有独立的刷新按钮 🔄
   - 无需刷新整个页面即可更新单个状态

### 🔄 新功能：保活（Keepalive）

1. **保活功能实现**
   - 启动时设置保活时长（0.5-24 小时，默认 4 小时）
   - 自动监控 Codespace 状态
   - 如果意外停止且未超时，自动重启
   - 显示剩余保活时间

2. **保活管理**
   - 弹窗设置保活时长
   - 实时显示保活状态和剩余时间
   - 可随时停止保活任务
   - 支持多个 Codespace 同时保活

3. **自动刷新机制**
   - 有保活任务时，页面每 60 秒自动刷新
   - 后台检查并维护 Codespace 状态
   - 显示活跃的保活任务数量

### 📚 文档更新

- 添加 `KEEPALIVE_GUIDE.md` 保活功能详细指南
- 更新使用说明和最佳实践

---

## [1.1.0] - 2025-10-26

### 🔐 新功能

1. **添加登录认证**
   - 需要用户名和密码才能访问应用
   - 登录凭证存储在 Streamlit Secrets
   - 默认凭证：username=`admin`, password=`admin`
   - 支持本地和云端环境

2. **数据持久化说明**
   - 本地：使用 `accounts.json` 文件
   - 云端：使用 Streamlit Secrets
   - 重启后自动加载所有账户

### 🔒 安全改进

1. **移除删除 Codespace 功能**
   - 为了安全，不再允许在应用中删除 Codespace
   - 请在 GitHub 网页端删除

2. **增强安全文档**
   - 添加 `SECURITY.md` 详细说明安全配置
   - 更新 README 包含存储位置说明
   - 更新 secrets 示例文件

### 📝 文档更新

- 添加登录配置说明
- 添加数据存储位置说明
- 添加 SECURITY.md 文档
- 更新快速开始指南

---

## [1.0.1] - 2025-10-26

### 🐛 Bug 修复

1. **修复 Windows pyarrow DLL 错误**
   - 移除了 pandas 依赖
   - 将 `st.dataframe()` 改为 `st.table()`
   - 解决了 "DLL load failed while importing lib" 错误

2. **修复删除 Codespace 功能**
   - 添加了删除确认机制
   - 使用 session state 跟踪确认状态
   - 点击 🗑️ 后显示 ⚠️ Confirm 按钮
   - 防止误删除操作

### 🎯 改进

- 减少了依赖包大小（移除 pandas）
- 改进了删除操作的用户体验
- 更好的错误处理

---

## [1.0.0] - 2025-10-26

### ✨ 初始版本

- 多账户支持
- Codespace 管理（列出、启动、停止、删除、创建）
- 本地和 Streamlit Cloud 双环境支持
- 现代化 UI 界面
- 完整的文档
